---
title: "Simulation Report"
output: html_notebook
---

```{r setup, include=FALSE}
library(ggplot2)

source("simulation_functions/MIC_utils.R")
source("simulation_functions/np_simulation.R")
source("simulation_functions/ph_simulation.R")
source("simulation_functions/po_simulation.R")
source("simulation_functions/real_simulation.R")
source("simulation_functions/generic_simulation.R")
```

#Data visualization 
```{r}

df <- transform_df(simulate_data_real(n = 1000)$dataframe, score_max = 11)
mean(df$T)

df_ <- df %>% filter(race == 0, sex == 1)

nrow(df %>% filter(Indicator == 1)) / nrow(df)

mean(df$T)

barplot(table(df_$T),
        main = "Bar Plot of Discrete Event Times",
        xlab = "Event Time (T)",
        ylab = "Frequency",
        col = "lightblue")

barplot(table(df$Delta),
        main = "Bar Plot of Delta",
        xlab = "Delta",
        ylab = "Frequency",
        col = "lightblue")

cor(df$T, df$Delta)

time <- system.time({
  fit_ <- MIC(df, user_formula = "cont + factor(sex) + factor(race)", method = "ph")
})
fit <- MIC(df, method = "pred.adj")

fit$meanT
fit_$meanT


plot(1:10, pmf(fit_$model, cov= list(race = 0, sex = 0, cont = 80), max_time = 10)$y)
#print(fit)
#print(fit_)

df
time
```


```{r}
res <- simulate_data_po(n = 400)
cond_pmf <- res$cond_pmf
cond_pmf(0, 0, 0)

```

```{r}
#result<- run_simulations(setup = 0, m = 2)
#print(result)
#save(result, file = "simulation_results/RData/April_18_2025_simulation.RData")

p_result <- run_simulations(setup = 0, m = 5, sim_model = c("simulate_data_np"), model = c("np","ph","po","roc","pred","pred.adj"), boot = TRUE)
print(p_result)

```
